Object subclass: #SADCodeGenerator	instanceVariableNames: 'stream'	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-Code Generator'!!SADCodeGenerator methodsFor: 'accessing' stamp: 'jws 11/21/2025 12:46'!stream	^ stream! !!SADCodeGenerator methodsFor: 'accessing' stamp: 'jws 11/21/2025 12:46'!stream: anObject	stream := anObject.! !!SADCodeGenerator methodsFor: 'initialize-release' stamp: 'jws 11/21/2025 12:49'!initialize	super initialize.	stream := WriteStream on: String new.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 09:48'!visitSADArgumentList: aSADArgumentList 	self stream nextPut: $(.	aSADArgumentList arguments		do: [:each | each accept: self]		separatedBy: [self stream nextPutAll: ', '].	self stream nextPut: $).! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 13:56'!visitSADArithmeticOp: aSADArithmeticOp 	self stream nextPutAll: aSADArithmeticOp cSymbol.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 12:07'!visitSADAssignment: aSADAssignment 	self stream 	nextPutAll: aSADAssignment identifier;	nextPutAll: ' = '.	aSADAssignment expression accept: self.	self stream nextPutAll: ';'; lf.	self stream lf.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 09:43'!visitSADBinaryExpression: aSADBinaryExpression 	aSADBinaryExpression arg1 accept: self.	self stream space.	aSADBinaryExpression op accept: self.	self stream space.	aSADBinaryExpression arg2 accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 11/24/2025 16:31'!visitSADBlockStatement: aSADBlockStatement 	self stream nextPutAll: '{'; lf.	aSADBlockStatement statements		do: [:each | each accept: self].	self stream nextPutAll: '}'; lf.			! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 11:11'!visitSADFunction: aSADFunction 	aSADFunction returnType accept: self.	self stream		nextPutAll: ' _';		nextPutAll: aSADFunction identifier.	aSADFunction parameters accept: self.	self stream nextPutAll: '{'.	self stream lf.	aSADFunction returnType accept: self.	self stream 		nextPutAll: ' ';		nextPutAll: aSADFunction identifier;		nextPutAll: ';'.	aSADFunction methodBody accept: self.	self stream		nextPutAll: 'return ';		nextPutAll: aSADFunction identifier;		nextPutAll: ';';		nextPutAll: '}'.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 09:47'!visitSADFunctionCall: aSADFunctionCall 		self stream nextPutAll: aSADFunctionCall identifier.	aSADFunctionCall arguments accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 12:57'!visitSADGroupExpression: aSADGroupExpression 	self stream nextPutAll: '('.	aSADGroupExpression expression accept: self.	self stream nextPutAll: ')'.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 12:11'!visitSADIOStatement: aSADIOStatement 	self stream		nextPutAll: 'printf("';		nextPutAll: aSADIOStatement formatSpecifier;		nextPutAll: '", '.	aSADIOStatement expression accept: self.	self stream nextPutAll: ');';lf.		! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 14:08'!visitSADIOWriteNewLineStatement: aSADIOWriteNewLineStatement 	self stream nextPutAll: 'printf("\n");'; lf.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 12:17'!visitSADIfThenElseStatement: aSADIfThenElseStatement 	self stream nextPutAll: 'if('.	aSADIfThenElseStatement expression accept: self.	self stream nextPutAll: ')'; lf.	aSADIfThenElseStatement trueStatement accept: self.	self stream nextPutAll: 'else'; lf.	aSADIfThenElseStatement falseStatement accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 12:18'!visitSADIfThenStatement: aSADIfThenStatement 	self stream nextPutAll: 'if('.	aSADIfThenStatement expression accept: self.	self stream nextPutAll: ')'; lf.	aSADIfThenStatement trueStatement accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 13:13'!visitSADLogicalOp: aSADLogicalOp 	stream nextPutAll: aSADLogicalOp cSymbol.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 11:46'!visitSADMethodBody: aSADMethodBody 	aSADMethodBody variables accept: self.	self stream lf.	aSADMethodBody statement accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'jws 11/21/2025 13:18'!visitSADMethods: aSADMethods 		aSADMethods methods		do: [:each | each accept: self]! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 09:33'!visitSADParameterList: aSADParameterList 	self stream nextPut: $(.	aSADParameterList parameters		do: [:each | each accept: self]		separatedBy: [self stream nextPutAll: ', '].	self stream nextPut: $).! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 14:08'!visitSADProcedure: aSADProcedure 		self stream 		nextPutAll: 'void ';		nextPutAll: aSADProcedure identifier.	aSADProcedure parameters accept: self.	self stream nextPutAll: '{'; lf.	aSADProcedure methodBody accept: self.	self stream nextPutAll: '}';lf.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 14:07'!visitSADProcedureCall: aSADProcedureCall 	self stream nextPutAll: aSADProcedureCall identifier.	aSADProcedureCall arguments accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 13:09'!visitSADProgram: aSADProgram 		self stream		nextPutAll: '#include <stdio.h>'; lf.	aSADProgram variables accept: self.	aSADProgram methods accept: self.	self stream lf.	self stream		nextPutAll: 'int main(int argc, char *argv[]){'; lf.	aSADProgram body accept: self.	self stream nextPutAll: '}'! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 13:26'!visitSADRelationalOp: aSADRelationalOp 	self stream nextPutAll: aSADRelationalOp cSymbol.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 11/24/2025 16:48'!visitSADTypeNode: aSADTypeNode 	self stream nextPutAll: aSADTypeNode type cName.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 12:48'!visitSADUnaryExpression: aSADUnaryExpression 	self stream nextPutAll: aSADUnaryExpression cOp.	aSADUnaryExpression expression accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 10:50'!visitSADVariableDeclaration: aSADVariableDeclaration 	aSADVariableDeclaration type accept: self.	self stream 		nextPutAll: ' ';		nextPutAll: aSADVariableDeclaration name.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 09:44'!visitSADVariableReference: aSADVariableReference 	self stream nextPutAll: aSADVariableReference name.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/8/2025 12:36'!visitSADVariables: aSADVariables 		aSADVariables variables		do: [:each | 			each accept: self. 			self stream nextPutAll: ';'; lf.].	! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 14:06'!visitSADWhileStatement: aSADWhileStatement 	self stream nextPutAll: 'while ('.	aSADWhileStatement expression accept: self.	self stream nextPutAll: ')'; lf.	aSADWhileStatement statement accept: self.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 12:55'!visitSADliteralBoolean: aSADliteralBoolean 	self stream	nextPutAll: aSADliteralBoolean cValue.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 10:54'!visitSADliteralInteger: aSADliteralInteger 	self stream 		nextPutAll: aSADliteralInteger value printString.! !!SADCodeGenerator methodsFor: 'visiting' stamp: 'WB 12/2/2025 10:54'!visitSADliteralString: aSADliteralString 	self stream 		nextPutAll: aSADliteralString value.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!SADCodeGenerator class	instanceVariableNames: ''!!SADCodeGenerator class methodsFor: 'as yet unclassified' stamp: 'jws 11/21/2025 12:48'!generate: aProgramString 		| ast generator |	ast := SADParser parse: aProgramString.	generator := self new.	ast accept: generator.	^generator stream contents! !TestCase subclass: #SADCodeGeneratorTestCase	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-Code Generator'!!SADCodeGeneratorTestCase methodsFor: 'accessing' stamp: 'WB 12/2/2025 13:31'!arithmeticProgram	^'sadness 	reasons		count isa integer		n isa integer	do		:-(			count <- 9			n <- count + 1			count <- (((n +12) / (3 * 4)) - 3) mod 4		)-:'! !!SADCodeGeneratorTestCase methodsFor: 'accessing' stamp: 'WB 12/1/2025 12:44'!factorialProgram	^'sadness 	reasons		fact6 isa integer	sorrows		disfunction factorial(n isa integer) isa integer		do			if n = 0 then				factorial <- 1			else				factorial <- n * factorial(n - 1)	do		:-(			fact6 <- factorial(6)			writeString "factorial 6 is "			writeInteger fact6			writeNewLine		)-:' withUnixLineEndings! !!SADCodeGeneratorTestCase methodsFor: 'accessing' stamp: 'WB 12/2/2025 12:13'!logicalProgram	^'sadness 	reasons		count isa integer		answer isa boolean	do		:-(			if true and not (3 = count) then				answer <- (count > 9) or (2 < count)		)-:'! !!SADCodeGeneratorTestCase methodsFor: 'accessing' stamp: 'jws 11/21/2025 12:43'!nanoProgram	^'sadness do writeNewLine'! !!SADCodeGeneratorTestCase methodsFor: 'accessing' stamp: 'WB 12/2/2025 13:57'!procedureProgram	^'sadnesssorrows	sob countdown()	reasons		count isa integer	do	:-(		count <- 10		while count > 0 do			:-(				writeInteger count				writeNewLine				count <- count - 1			)-:		writeString "BLASTOFF!!"	)-:do	countdown()'					! !!SADCodeGeneratorTestCase methodsFor: 'accessing' stamp: 'WB 12/1/2025 12:33'!variablesProgram		^'sadness	reasons		count isa integer		message isa string		darei isa boolean	do		:-(			count <- 9			message <- "hello"			darei <- true		)-:' withUnixLineEndings! !!SADCodeGeneratorTestCase methodsFor: 'running' stamp: 'WB 12/2/2025 14:09'!testArithmeticProgram	| cCode |	cCode := SADCodeGenerator generate: self arithmeticProgram.	cCode inspect.! !!SADCodeGeneratorTestCase methodsFor: 'running' stamp: 'WB 12/2/2025 11:23'!testFactorialProgram	| cCode |	cCode := SADCodeGenerator generate: self factorialProgram.	cCode inspect! !!SADCodeGeneratorTestCase methodsFor: 'running' stamp: 'WB 12/2/2025 13:50'!testLogicalProgram	| cCode |	cCode := SADCodeGenerator generate: self logicalProgram.	cCode inspect! !!SADCodeGeneratorTestCase methodsFor: 'running' stamp: 'WB 12/3/2025 12:16'!testNanoProgram	| cCode |	cCode := SADCodeGenerator generate: self nanoProgram.	cCode inspect! !!SADCodeGeneratorTestCase methodsFor: 'running' stamp: 'WB 12/2/2025 14:12'!testProcedureProgram	| cCode |	cCode := SADCodeGenerator generate: self procedureProgram.	cCode inspect! !!SADCodeGeneratorTestCase methodsFor: 'running' stamp: 'WB 12/1/2025 12:42'!testVariablesProgram	| cCode |	cCode := SADCodeGenerator generate: self variablesProgram.	cCode inspect! !