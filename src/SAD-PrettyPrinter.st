Object subclass: #SADPrettyPrinter	instanceVariableNames: 'stream indentLevel'	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-PrettyPrinter'!!SADPrettyPrinter methodsFor: 'formatting' stamp: 'jws 11/20/2025 12:39'!indent	self stream tab: self indentLevel! !!SADPrettyPrinter methodsFor: 'formatting' stamp: 'jws 11/30/2025 21:12'!lf		self stream lf! !!SADPrettyPrinter methodsFor: 'formatting' stamp: 'jws 11/20/2025 12:38'!tabIn	indentLevel := indentLevel + 1! !!SADPrettyPrinter methodsFor: 'formatting' stamp: 'jws 11/20/2025 12:38'!tabOut	indentLevel := indentLevel - 1! !!SADPrettyPrinter methodsFor: 'initialize-release' stamp: 'jws 11/20/2025 12:47'!initialize	super initialize.	stream := WriteStream on: String new.	indentLevel := 0.! !!SADPrettyPrinter methodsFor: 'accessing' stamp: 'jws 11/20/2025 12:37'!indentLevel	^ indentLevel! !!SADPrettyPrinter methodsFor: 'accessing' stamp: 'jws 11/20/2025 12:37'!indentLevel: anObject	indentLevel := anObject.! !!SADPrettyPrinter methodsFor: 'accessing' stamp: 'jws 11/20/2025 12:37'!stream	^ stream! !!SADPrettyPrinter methodsFor: 'accessing' stamp: 'jws 11/20/2025 12:37'!stream: anObject	stream := anObject.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:09'!visitSADArgumentList: aSADArgumentList 		self stream nextPut: $(.	aSADArgumentList arguments		do: [:each | each accept: self]		separatedBy: [self stream nextPutAll: ', '].	self stream nextPut: $).! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:06'!visitSADArithmeticOp: aSADArithmeticOp 		self stream nextPutAll: aSADArithmeticOp symbol! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:35'!visitSADAssignment: aSADAssignment 		self indent.	self stream 		nextPutAll: aSADAssignment identifier;		nextPutAll: ' <- '.	aSADAssignment expression accept: self.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:05'!visitSADBinaryExpression: aSADBinaryExpression 		aSADBinaryExpression arg1 accept: self.	self stream space.	aSADBinaryExpression op accept: self.	self stream space.	aSADBinaryExpression arg2 accept: self.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:34'!visitSADBlockStatement: aSADBlockStatement 	self indent.	self stream		nextPutAll: ':-('; 		lf.	self tabIn.	aSADBlockStatement statements		do: 			[:each | 			each accept: self.			self stream lf].	self tabOut; indent.	self stream nextPutAll: ')-:'! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:58'!visitSADFunction: aSADFunction 		self indent.	self stream		nextPutAll: 'disfunction ';		nextPutAll: aSADFunction identifier.	aSADFunction parameters accept: self.	self stream nextPutAll: ' isa '.	aSADFunction returnType accept: self.	self stream lf.	aSADFunction methodBody accept: self.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:08'!visitSADFunctionCall: aSADFunctionCall 		self stream nextPutAll: aSADFunctionCall identifier.	aSADFunctionCall arguments accept: self.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:15'!visitSADIOStatement: aSADIOStatement 	self indent.	self stream 		nextPutAll: aSADIOStatement writeSymbol;		space.	aSADIOStatement expression accept: self! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:16'!visitSADIOWriteNewLineStatement: aSADIOWriteNewLineStatement 	self indent.		self stream		nextPutAll: 'writeNewLine'.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:19'!visitSADIfThenElseStatement: aSADIfThenElseStatement 	self indent.	self stream nextPutAll: 'if '.	aSADIfThenElseStatement expression accept: self.	self stream nextPutAll: ' then'.	self lf; tabIn.	aSADIfThenElseStatement trueStatement accept: self.	self lf; tabOut; indent.	self stream nextPutAll: 'else'.	self lf; tabIn.	aSADIfThenElseStatement falseStatement accept: self.	self lf; tabOut.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:17'!visitSADMethodBody: aSADMethodBody 		self tabIn.	aSADMethodBody variables accept: self.	aSADMethodBody statement accept: self.	self tabOut.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:53'!visitSADMethods: aSADMethods 		aSADMethods methods isEmpty		ifTrue: [^self].	self tabIn; indent.	self stream nextPutAll: 'sorrows'; lf.	self tabIn.	aSADMethods methods		do: [:each | each accept: self].	self tabOut; tabOut.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:58'!visitSADParameterList: aSADParameterList 		self stream nextPut: $(.	aSADParameterList parameters		do: [:each | each accept: self]		separatedBy: [self stream nextPutAll: ', '].	self stream nextPut: $).! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/21/2025 12:16'!visitSADProgram: aSADProgram 		self stream nextPutAll: 'sadness'; lf.	aSADProgram variables accept: self.	aSADProgram methods accept: self.	self tabIn; indent.	self stream nextPutAll: 'do'; lf.	self tabIn.	aSADProgram body accept: self.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:06'!visitSADRelationalOp: aSADRelationalOp 		self stream nextPutAll: aSADRelationalOp symbol! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/21/2025 12:32'!visitSADTypeNode: aSADTypeNode 		self stream nextPutAll: aSADTypeNode type name! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:49'!visitSADVariableDeclaration: aSADVariableDeclaration 		self stream		nextPutAll: aSADVariableDeclaration name;		nextPutAll: ' isa '.	aSADVariableDeclaration type accept: self.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 21:05'!visitSADVariableReference: aSADVariableReference 		self stream nextPutAll: aSADVariableReference name! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:51'!visitSADVariables: aSADVariables 		aSADVariables variables isEmpty		ifTrue: [^self].	self tabIn; indent.	self stream nextPutAll: 'reasons'; lf.	self tabIn.	aSADVariables variables 		do: 			[:each | 			self indent.			each accept: self.			self stream lf].	self tabOut; tabOut.! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:36'!visitSADliteralInteger: aSADliteralInteger 		self stream nextPutAll: aSADliteralInteger value printString! !!SADPrettyPrinter methodsFor: 'visiting' stamp: 'jws 11/30/2025 20:37'!visitSADliteralString: aSADliteralString 		self stream nextPutAll: aSADliteralString quotedPrintString! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!SADPrettyPrinter class	instanceVariableNames: ''!!SADPrettyPrinter class methodsFor: 'printing' stamp: 'jws 11/20/2025 12:46'!prettyPrint: aString 		| ast printer |	ast := SADParser parse: aString.	printer := self new.	ast accept: printer.	^printer stream contents! !TestCase subclass: #SADPrettyPrinterTestCase	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-PrettyPrinter'!!SADPrettyPrinterTestCase methodsFor: 'running' stamp: 'jws 11/30/2025 21:20'!testPoorFactorialProgram	| formatted |	formatted := SADPrettyPrinter prettyPrint: self poorFactorialProgram.	self		assert: self factorialProgram		equals: formatted! !!SADPrettyPrinterTestCase methodsFor: 'running' stamp: 'jws 11/20/2025 12:42'!testPoorNanoProgram	| formatted |	formatted := SADPrettyPrinter prettyPrint: self poorNanoProgram.	self		assert: self nanoProgram		equals: formatted! !!SADPrettyPrinterTestCase methodsFor: 'running' stamp: 'jws 11/21/2025 12:25'!testPoorVariablesProgram	| formatted |	formatted := SADPrettyPrinter prettyPrint: self poorVariablesProgram.	self		assert: self variablesProgram		equals: formatted! !!SADPrettyPrinterTestCase methodsFor: 'accessing' stamp: 'jws 11/30/2025 21:20'!factorialProgram	^'sadness	reasons		fact5 isa integer	sorrows		disfunction factorial(n isa integer) isa integer			if n = 0 then				factorial <- 1			else				factorial <- n * factorial(n - 1)	do		:-(			fact5 <- factorial(5)			writeString "factorial 5 is "			writeInteger fact5			writeNewLine		)-:' withUnixLineEndings! !!SADPrettyPrinterTestCase methodsFor: 'accessing' stamp: 'jws 11/30/2025 21:22'!nanoProgram	^ 'sadness	do		writeNewLine' withUnixLineEndings! !!SADPrettyPrinterTestCase methodsFor: 'accessing' stamp: 'jws 11/30/2025 20:30'!poorFactorialProgram	^'sadness  reasons fact5 isa integer sorrows disfunction 	factorial(n isa integer) isa integer do if n = 0 then factorial <- 1 elsefactorial <- n * factorial(n - 1) do :-( fact5 <- factorial(5)writeString "factorial 5 is " writeInteger fact5 writeNewLine )-:'! !!SADPrettyPrinterTestCase methodsFor: 'accessing' stamp: 'jws 11/21/2025 12:01'!poorNanoProgram	^'sadness                 do             					writeNewLine'! !!SADPrettyPrinterTestCase methodsFor: 'accessing' stamp: 'jws 11/21/2025 12:24'!poorVariablesProgram	^'sadness  reasons count isa integer message isa string do :-( count <- 9message <- "hello")-:'! !!SADPrettyPrinterTestCase methodsFor: 'accessing' stamp: 'jws 11/30/2025 20:43'!variablesProgram	^'sadness	reasons		count isa integer		message isa string	do		:-(			count <- 9			message <- "hello"		)-:'  withUnixLineEndings! !