Object subclass: #SADType	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!SADType class	instanceVariableNames: 'default'!!SADType class methodsFor: 'accessing' stamp: 'jws 11/5/2025 12:20'!default	default isNil ifTrue: [default := self new].	^default! !!SADType class methodsFor: 'as yet unclassified' stamp: 'WB 11/17/2025 12:37'!boolean		^SADBooleanType default.! !!SADType class methodsFor: 'as yet unclassified' stamp: 'WB 11/17/2025 12:37'!integer		^SADIntegerType default.! !!SADType class methodsFor: 'as yet unclassified' stamp: 'WB 11/17/2025 12:37'!string		^SADStringType default.! !SADType subclass: #SADBooleanType	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!!SADBooleanType methodsFor: 'accessing' stamp: 'WB 12/2/2025 13:05'!cName	^'int'.! !!SADBooleanType methodsFor: 'accessing' stamp: 'WB 11/24/2025 15:24'!name	^'boolean'.! !!SADBooleanType methodsFor: 'type checking' stamp: 'jws 11/5/2025 12:43'!checkType: aBoolean 		aBoolean isBoolean		ifFalse: [SADTypeError signal: 'boolean']! !SADType subclass: #SADErrorType	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!!SADErrorType methodsFor: 'type checking' stamp: 'WB 12/5/2025 08:24'!checkType: aType 	"do nothing on purpose"	^self.! !SADType subclass: #SADIntegerType	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!!SADIntegerType methodsFor: 'accessing' stamp: 'WB 11/24/2025 16:49'!cName	^'int'.! !!SADIntegerType methodsFor: 'accessing' stamp: 'WB 11/24/2025 15:24'!name	^'integer'.! !!SADIntegerType methodsFor: 'type checking' stamp: 'jws 11/5/2025 12:43'!checkType: anInteger 		anInteger isInteger		ifFalse: [SADTypeError signal: 'integer']! !SADType subclass: #SADStringType	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!!SADStringType methodsFor: 'accessing' stamp: 'WB 12/8/2025 15:07'!cName	^'char*'! !!SADStringType methodsFor: 'accessing' stamp: 'WB 11/24/2025 15:24'!name	^'string'.! !!SADStringType methodsFor: 'type checking' stamp: 'jws 11/5/2025 12:42'!checkType: aString 		aString isString		ifFalse: [SADTypeError signal: 'string']! !TestCase subclass: #SADTypeTestCase	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!!SADTypeTestCase methodsFor: 'running' stamp: 'jws 11/5/2025 12:39'!testBooleanType	SADBooleanType default checkType: false.	self		should: [SADBooleanType default checkType: 7]		raise: SADTypeError.	self 		should: [SADBooleanType default checkType: 'nine']		raise: SADTypeError.! !!SADTypeTestCase methodsFor: 'running' stamp: 'jws 11/3/2025 12:49'!testIntegerType	SADIntegerType default checkType: 7.	self		should: [SADIntegerType default checkType: 'nine']		raise: SADTypeError.	self 		should: [SADIntegerType default checkType: false]		raise: SADTypeError.! !!SADTypeTestCase methodsFor: 'running' stamp: 'jws 11/5/2025 12:37'!testStringType	SADStringType default checkType: 'nine'.	self		should: [SADStringType default checkType: 7]		raise: SADTypeError.	self 		should: [SADStringType default checkType: false]		raise: SADTypeError.! !!SADTypeTestCase methodsFor: 'running' stamp: 'jws 11/5/2025 12:26'!testTypeSingleton	| aType sameType |	aType := SADIntegerType default.	sameType :=  SADIntegerType default.	self assert: (aType == sameType).	aType := SADStringType default.	sameType :=  SADStringType default.	self assert: (aType == sameType).	aType := SADBooleanType default.	sameType :=  SADBooleanType default.	self assert: (aType == sameType).! !Object subclass: #SADVariable	instanceVariableNames: 'value type'	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!!SADVariable methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:40'!get	^value! !!SADVariable methodsFor: 'accessing' stamp: 'WB 12/8/2025 15:47'!set: aValue 	self type checkType: aValue.	value := aValue.! !!SADVariable methodsFor: 'accessing' stamp: 'jws 11/5/2025 12:51'!type	^ type! !!SADVariable methodsFor: 'accessing' stamp: 'jws 11/5/2025 12:51'!type: anObject	type := anObject.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!SADVariable class	instanceVariableNames: ''!!SADVariable class methodsFor: 'instance creation' stamp: 'jws 11/6/2025 12:47'!boolean	^self type: SADBooleanType default! !!SADVariable class methodsFor: 'instance creation' stamp: 'jws 11/6/2025 12:48'!integer			^self type: SADIntegerType default! !!SADVariable class methodsFor: 'instance creation' stamp: 'jws 11/6/2025 12:48'!string	^self type: SADStringType default.! !!SADVariable class methodsFor: 'instance creation' stamp: 'jws 11/6/2025 12:49'!type: aType	^self new		type: aType;		yourself! !SADVariable subclass: #SADErrorVariable	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!TestCase subclass: #SADVariableTestCase	instanceVariableNames: 'integerVar stringVar booleanVar'	classVariableNames: ''	poolDictionaries: ''	category: 'SAD-TypeAndVariables'!!SADVariableTestCase methodsFor: 'running' stamp: 'jws 11/6/2025 12:46'!testBooleanVariable	self 		assert: nil 		equals: self booleanVar get.	self booleanVar set: true.	self 		assert: true		equals: self booleanVar get.	self 		should: [self booleanVar set: self sampleIntegerValue]		raise: SADTypeError.	self		should: [self booleanVar set: 'magic']		raise: SADTypeError.! !!SADVariableTestCase methodsFor: 'running' stamp: 'jws 11/6/2025 12:24'!testIntegerVariable	self 		assert: nil 		equals: self integerVar get.	self integerVar set: self sampleIntegerValue.	self 		assert: self sampleIntegerValue 		equals: self integerVar get.	self 		should: [self integerVar set: 'magic']		raise: SADTypeError.	self		should: [self integerVar set: true]		raise: SADTypeError.! !!SADVariableTestCase methodsFor: 'running' stamp: 'jws 11/6/2025 12:44'!testStringVariable	self 		assert: nil 		equals: self stringVar get.	self stringVar set: 'magic'.	self 		assert: 'magic' 		equals: self stringVar get.	self 		should: [self stringVar set: self sampleIntegerValue]		raise: SADTypeError.	self		should: [self stringVar set: true]		raise: SADTypeError.! !!SADVariableTestCase methodsFor: 'initialize-release' stamp: 'jws 11/5/2025 12:51'!setUp	super setUp.	integerVar := SADVariable integer.	stringVar := SADVariable string.	booleanVar := SADVariable boolean.! !!SADVariableTestCase methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:16'!booleanVar	^ booleanVar! !!SADVariableTestCase methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:16'!booleanVar: anObject	booleanVar := anObject.! !!SADVariableTestCase methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:16'!integerVar	^ integerVar! !!SADVariableTestCase methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:16'!integerVar: anObject	integerVar := anObject.! !!SADVariableTestCase methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:23'!sampleIntegerValue	^ 17! !!SADVariableTestCase methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:16'!stringVar	^ stringVar! !!SADVariableTestCase methodsFor: 'accessing' stamp: 'jws 11/6/2025 12:16'!stringVar: anObject	stringVar := anObject.! !